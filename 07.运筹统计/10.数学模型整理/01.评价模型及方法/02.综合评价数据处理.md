# 02.综合评价数据处理

评价指标体系的建立，使整个被评价系统的综合情况得到了体现。但由于被评价系统本身的复杂性，使得评价指标多种多样，根据各指标的性质，一般说来，可将指标分为**定量指标**和**定性指标**两大类。对各定量指标来说，它们具有不同的量纲，对定性指标而言其描述的方式也不一致。因此，为了对整个系统进行综合评价，必须将各指标进行标准化的处理，使定性指标科学地得以量化，将定量指标进行一致化处理和无量纲化处理。

## 一、定量指标的一致化处理

一致化处理就是将评价指标的类型进行统一。一般来说，在评价指标体系中，可能会同时存在**极大型指标(指标值越大越好的指标)**、**极小型指标(指标值越小越好的指标)**、**居中型指标(指标值取一个中间值最好的指标)**和**区间型指标(指标值取在某个区间内为最好的指标)**。若指标体系中存在不同类型的指标，必须在综合评价之前将评价指标的类型做一致化处理。例如，将各类指标都转化为极大型指标或极小型指标。一般的做法是将非极大型指标转化为极大型指标。但是，在不同的指标权重确定方法和评价模型中指标一致化处理也有差异。

设评价对象的指标变量分别为$X_j$（$j=1,2,...,m$），评价对象有$n$个，第$i$($i=1,2,...,n$)个评价对象关于$X_i$的观测值为$(x_{i1},x_{i2},...,x_{im})$。

### 1.极小型指标转化为极大型指标

可以使用如下公式实现指标逆转

- 取倒数：$x_{ij}^{\prime}=\frac{1}{x_{ij}}$，（$x_{ij}x_{ik}>0$，$j,k =1,2,...,m$）

- 负向化：$x_{ij}^{\prime}=-x_{ij}$

- 极差变化：$x_{ij}^{\prime}=\max(X_{i})-x_{ij}$
- 加常数：$x_{ij}^{\prime}=M-x_{ij},一般要求M \geq max(X_{i})$

注意取倒数操作适合原指标数据符号一致（同正或同负）的情况。

### 2.居中型指标转化为极大型指标

若不知最优指标值，可令$M_i=\max(X_i)$，$m_i=\min(X_i)$，可以取：
$$
x_{ij}^{\prime}=
\begin{cases} 
\frac{2(x_{ij}-m_i)}{M_i-m_i},\quad m_i\leq{x_{ij}}\leq{\frac{M_i-m_i}{2}}\\[2ex]
\frac{2(M_i-x_{ij})}{M_i-m_i}, \quad \frac{M_i-m_i}{2}\leq{x_{ij}}\leq{M_i} 
\end{cases}
$$
若知道具体最优目标值为$x_i^*$​​，可以先将原数据减去最优目标值并进行取绝对值或者平方计算与最优目标值的距离，将其转化为极小型指标（距离越大，数值越小），在按（1）逆向变化，如：
$$
x_{ij}^{\prime}=-|x_{ij}-x^*_i| + k\\
x_{ij}^{\prime}=-(x_{ij}-x^*_i)^2 + k
$$
$k$是一个常数，可有可无，可以取$k\geq{\max(|x_{ij}-x_i^*|)}$以使转化后的结果为正。

### 3.区间型指标化为极大型指标

区间型指标是指$x_{ij}$取值最好介于区间$[a_i,b_i]$​内，距离该区间越远越差。

- 双线性变换

$$
x_{ij}^{\prime}=
\begin{cases}
k-(a_i-x_{ij}),\quad x_{ij}<a_i\\[2ex]
k,\quad a_{i}\leq{x_{ij}}\leq{b_i}\\[2ex]
k-(x_{ij}-b_i),\quad  x_{ij}>b_i
\end{cases}
$$

- 令$M_i=\max({X_i})$，$m_i=\min(X_i)$，$c_i=\max(\{a_i-m_i,M_i-b_i\})$，转化：

$$
x_{ij}^{\prime}=
\begin{cases} 
k-\frac{a_i-x_{ij}}{c_i}k,\quad x_{ij}<a_i\\[2ex]
k, \quad a_{i}\leq{x_{ij}}\leq{b_i}\\[2ex]
k-\frac{x_{ij}-b_i}{c_i}k,,\quad x_{ij}>b_i
\end{cases}
$$

其中$k$应该是一个不为0的常数，用于确定变化后的区间，转化后$x_{ij}^{\prime}\in[0,k]$内。

- 三角函数变化

令$c_i=\frac{a_i+b_i}{2}$，$w_i=b_i-a_i$，做三角变化：
$$
x_{ij}^{\prime}=cos(\frac{x_{ij}-c_i}{w_i}\pi)
$$
该方法可以将区间内的值被映射为较大的数值，而区间外的数值逐渐减小，更适合最优区间比较窄的情况。

实际上，可以根据最优区间的长度进行任意的函数变化，使得函数在最优区间内达到峰值，而在区间外逐渐减小。如二次函数：
$$
x_{ij}^{\prime}=-(\max(0,x_{ij}-b_i)^2+\max(0,a_i-x_{ij})^2)+k
$$
这里的$k$是一个常数，可有可无，可以取足够大以使结果全部为正。

## 二、定量指标的无量纲化处理

无量纲化，也称为指标值的规范化，是通过数学变换来消除原始指标值的单位及其数值数量级影响的过程。因此，就有指标的实际值和评价值之分。一般地，**将指标无量纲化处理以后的值称为指标评价值**。无量纲化过程就是将指标实际值转化为指标评价值的过程。

> 指标的无量纲化实际上也在抹除数据的特征，比如$z-score$方法抹杀了原始数据的均值和方差，比例法则缩小了特征之间的差异，...，如果特征之间的差异并不是很大且量纲也相同，其实有时候不进行无量纲化得到的评价结果更精确。当然，这种情况比较少。
>
> 有时候进行无量纲化处理的目的和所使用的方法有关，如熵权法会要求$x_{ij}>0$，因此$z-score$并不能保证这一结果。

设评价对象的指标变量分别为$X_j$（$j=1,2,...,m$），评价对象有$n$个，第$i$($i=1,2,...,n$)个评价对象关于$X_i$的观测值为$(x_{i1},x_{i2},...,x_{im})$。

### 1.z-score标准化

设样本均值$\mu_i=\frac{1}{n}\sum_{j=1}^n{x_{ij}}$，样本标准差$s_i=\sqrt{\frac{1}{n-1}\sum_{j=1}^n{(x_{ij}-\mu_i)^2}}$，则有：
$$
x_{ij}^{\prime}=\frac{x_{ij}-\mu_i}{s_i}
$$

### 2.比例变换法

设$M_i=\max(X_i)$，$m_i=\min(X_i)$，则有如下变换：

对于极大型指标：$x_{ij}^{\prime}=\frac{x_{ij}}{M_i}$

对于极小型指标：$x_{ij}^{\prime}=\frac{m_i}{x_{ij}}$或$x_{ij}^{\prime}=1-\frac{x_{ij}}{M_i}$

该方法的优点是变换前后的属性值成比例。但对任一指标来说，变换后的$x_{ij}^{\prime}=1$和$x_{ij}^{\prime}=0$不一定同时出现。

### 3.向量归一化

对于极大型指标：$x_{ij}^{\prime}=\frac{x_{ij}}{\sqrt{\sum_{i=1}^n}{x_{ij}^2}}$

对于极小型指标：$x_{ij}^{\prime}=1-\frac{x_{ij}}{\sqrt{\sum_{i=1}^n}{x_{ij}^2}}$

### 4.极差归一化

设$M_i=\max(X_i)$，$m_i=\min(X_i)$，则有如下变换：

对于极大型指标：$x_{ij}^{\prime}=\frac{x_{ij}-m_i}{M_i-m_i}$

对于极小型指标：$x_{ij}^{\prime}=\frac{M_i-x_{ij}}{M_i-m_i}$

其特点为经过极差变换后，均有$0\leq{x_{ij}^{\prime}}\leq1$，且最优指标值为1，最劣指标值为0，该方法的缺点是变换前后的各指标值不成比例。

### 5.功效系数法

$$
x_{ij}^{\prime}=k+\frac{x_{ij}-\min(X_i)}{\max(X_i)-\min(X_i)}\times{d}
$$

其中，$k$和$d$均为常数，$k$被称为平移量，代表变化后的最小值，$d$被称为旋转量，代表示“放大”或“缩小”倍数，变化后有$x_{ij}^{\prime}\in[k,k+d]$。

## 三、定性指标的定量化

在综合评价工作中，有些评价指标是定性指标，即只给出定性的描述，例如质量很好、性能一般、可靠性高等。对于这些指标，在进行综合评价时，必须先通过适当的方式进行赋值，使其量化。一般来说，对于指标最优值可赋值1，对于指标最劣值可赋值0。对极大型和极小型定性指标常按以下方式赋值。

### 1.极大型定性指标量化方法

对于极大型定性指标而言，如果指标能够分为很低、低、一般、高和很高5个等级，则可以主观地分别取量化值为0、0.3、0.5、0.7、1，介于两个等级之间的可以取两个分值之间的适当数值作为量化值。

|  等级  | 很低 |  低  | 一般 |  高  | 很高 |
| :----: | :--: | :--: | :--: | :--: | :--: |
| 量化值 |  0   | 0.3  | 0.5  | 0.7  |  1   |

### 2.极小型定性指标量化方法

对于极小型定性指标而言，如果指标能够分为很高、高、一般，低和很低5个等级，则可以主观地分别取量化值为0、0.3、0.5、0.7、1，介于两个等级之间的可以取两个分值之间的适当数值作为量化值。



|  等级  | 很高 |  高  | 一般 |  低  | 很低 |
| :----: | :--: | :--: | :--: | :--: | :--: |
| 量化值 |  0   | 0.3  | 0.5  | 0.7  |  1   |

